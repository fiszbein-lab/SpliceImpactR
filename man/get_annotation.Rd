% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_annotations.R
\name{get_annotation}
\alias{get_annotation}
\title{Load and prepare genomic annotation and sequence data}
\usage{
get_annotation(
  load = c("link", "path", "dataframe", "test"),
  gtf_df = NULL,
  gtf_path = NULL,
  link = NULL,
  base_dir = NULL,
  species = "human",
  release = 45,
  mode = "download",
  use_rds_cache = TRUE,
  fetch_sequences = TRUE,
  transcript_path = NULL,
  translation_path = NULL,
  filter_tsl = c("1", "2", "3", "4", "5")[1:3]
)
}
\arguments{
\item{load}{One of \code{test}, \code{"dataframe"}, \code{"path"}, or \code{"link"},
specifying how to obtain the annotation:
\itemize{
  \item \code{"test"} — load minimal annotation for quick testing.
  \item \code{"dataframe"} — use an in-memory \code{gtf_df} or
    \code{assets$gtf_df}.
  \item \code{"path"} — load a local file specified by \code{gtf_path}
    or \code{assets$paths$gtf_gz}.
  \item \code{"link"} — download directly from a remote URL or via
    \code{.si_prepare_assets()}.
}}

\item{gtf_df}{Optional GTF data.frame already loaded in memory.}

\item{gtf_path}{Path to a GTF file (gzipped or uncompressed).}

\item{link}{Remote URL pointing to a GTF resource.}

\item{base_dir}{Directory used for downloaded or cached assets.
Defaults to [resolve_output_dir()].}

\item{species}{Character scalar; one of \code{"human"} or
\code{"mouse"}.}

\item{release}{Integer GENCODE release number (e.g. 45).}

\item{mode}{Either \code{"download"} or \code{"import_then_cache"} for
controlling caching behavior.}

\item{use_rds_cache}{Logical; if \code{TRUE}, use cached RDS versions
of GTFs when available.}

\item{fetch_sequences}{Logical; if \code{TRUE}, also load transcript
and protein sequences via [get_sequences()].}

\item{transcript_path}{Path or URL to transcript FASTA file
(e.g. \code{gencode.v45.pc_transcripts.fa.gz}).}

\item{translation_path}{Path or URL to protein FASTA file
(e.g. \code{gencode.v45.pc_translations.fa.gz}).}

\item{filter_tsl}{Character vector of transcript support levels (TSL)
to retain; defaults to TSL 1–3.}

\item{prep_assets}{Logical; if \code{TRUE}, automatically run
[SpliceImpactR::si_prepare_assets()] before loading.}
}
\value{
A list with components:
  \itemize{
    \item \code{annotations}: cleaned and annotated GTF data.table
    \item \code{hybrids}: list of first/last exon overlaps
    \item \code{sequences}: combined transcript/protein sequence map
  }
}
\description{
High-level wrapper to load GENCODE or Ensembl GTF annotations together
with corresponding transcript and protein FASTA sequences. Supports
multiple input modes, automatic asset preparation and caching, and
built-in filtering for high-confidence transcripts.
}
\details{
This function unifies annotation import, transcript filtering, and
optional sequence retrieval in a single step. It harmonizes column
names, adds exon-level coding and ordering information, and filters
low-confidence transcripts (TSL > 3) by default.

Remote or cached asset handling is done via [resolve_output_dir()]
and [SpliceImpactR:::.si_prepare_assets()].
}
\examples{
annots <- get_annotation(load = 'test')

}
\seealso{
[load_gtf_long()], [get_sequences()],
  [resolve_output_dir()]
}
