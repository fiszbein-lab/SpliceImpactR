% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_multi_analysis.R
\name{compare_hit_index}
\alias{compare_hit_index}
\title{Compare HIT index values between conditions}
\usage{
compare_hit_index(
  sample_df,
  condition_map = c(control = "control", test = "case"),
  minimum_proportion = 0.5,
  top_n_heatmap = 5000,
  sig_delta = 0.2,
  fdr_thresh = 0.05,
  seed = 1L
)
}
\arguments{
\item{sample_df}{`data.frame` or `data.table` containing sample metadata
with columns: `path`, `sample_name`, and `condition`.}

\item{condition_map}{Named character vector mapping experimental groups,
e.g. `c(control = "control", test = "case")`.}

\item{minimum_proportion}{Minimum proportion of samples per group
that must have valid HIT values for a test to be performed
(default = 0.5).}

\item{top_n_heatmap}{Integer; number of events to display in the heatmap
ordered by absolute ΔHIT (default = 5000).}

\item{sig_delta}{Absolute ΔHIT threshold for volcano highlighting
(default = 0.2).}

\item{fdr_thresh}{FDR threshold for volcano significance lines
(default = 0.05).}

\item{seed}{Random seed for reproducible downsampling of heatmap
events (default = 1).}
}
\value{
A named list with:
\describe{
  \item{`results`}{Data.table of per-event statistics (means, p, FDR, ΔHIT)}
  \item{`plot`}{Patchwork object with 4-panel summary visualization}
}
}
\description{
Computes per-event differences in the **HIT index** (Hybrid Intron Tolerance)
between control and test conditions, performs Wilcoxon tests,
adjusts for multiple testing, and produces summary visualizations.
}
\details{
For each exon-level HIT index event:
\itemize{
  \item Computes mean HIT per group (`control`, `test`)
  \item Performs a Wilcoxon rank-sum test if both groups
        have ≥50% of samples with valid values
  \item Adjusts p-values via Benjamini–Hochberg FDR
  \item Computes signed (`diff_HIT`) and absolute (`delta_HIT`) changes
}

The function returns both the full per-event results table
and a combined 2×2 patchwork plot containing:
\enumerate{
  \item Control vs Test mean HIT scatter
  \item Top-|ΔHIT| heatmap (control/test columns)
  \item Volcano plot of |ΔHIT| vs –log10(FDR)
  \item Density of ΔHIT distribution
}
}
\examples{
sample_frame <- data.frame(path = c(check_extdata_dir('rawData/control_S5/'),
                                    check_extdata_dir('rawData/control_S6/'),
                                    check_extdata_dir('rawData/control_S7/'),
                                    check_extdata_dir('rawData/control_S8/'),
                                    check_extdata_dir('rawData/case_S1/'),
                                    check_extdata_dir('rawData/case_S2/'),
                                    check_extdata_dir('rawData/case_S3/'),
                                    check_extdata_dir('rawData/case_S4/')),
                           sample_name  = c("S5", "S6", "S7", "S8", "S1", "S2", "S3", "S4"),
                           condition    = c("control", "control", "control", "control", "case",  "case",  "case",  "case"),
                           stringsAsFactors = FALSE)
hit_compare <- compare_hit_index(sample_frame, condition_map = c(control = "control", test = "case"))
}
\seealso{
[.getHITindex()]
}
