% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_annotation_matches.R
\name{match_events_to_annotations_vec}
\alias{match_events_to_annotations_vec}
\title{Match alternative splicing events to annotated exons and transcripts}
\usage{
match_events_to_annotations_vec(events, annotations, minOverlap = 0.05)
}
\arguments{
\item{events}{A `data.frame` or `data.table` containing splicing events with
columns `chr`, `strand`, `gene_id`, and coordinate fields `inc` and `exc`
(semicolon‐delimited `"start-end"` strings).}

\item{annotations}{A gene annotation table (e.g. from
[rtracklayer::import()] on a GTF file) with exon and transcript rows, passed
to [build_from_annotations()].}

\item{minOverlap}{Minimum fractional overlap (0–1) required between an
inclusion segment and an annotated exon to count as a hit. Default `0.05`.}
}
\value{
A `data.table` containing one row per input event with the following
  appended columns:
  \describe{
    \item{`transcript_id`}{The best‐matching transcript ID.}
    \item{`exons`}{Semicolon‐delimited list of exon IDs covered by the event.}
    \item{`inc_exons_by_idx`}{Semicolon‐delimited exon IDs per inclusion
      index (maintaining order).}
    \item{`inc_rows_by_idx`}{Semicolon‐delimited exon row indices matching
      inclusion order.}
  }
}
\description{
Performs vectorized overlap mapping between event coordinates (e.g. inclusion
or exclusion intervals) and exons from an annotation resource. Returns the
best‐matching transcript and exon set per event based on coverage, exon
classification, and protein‐coding preference.
}
\details{
The function uses [GenomicRanges::findOverlaps()] to match event inclusion
intervals to exons. Candidate transcripts are filtered to ensure sufficient
coverage and absence of overlaps with exclusion coordinates.

Internal helpers used:
  * [build_from_annotations()] — prepares exon/transcript tables
  * [explode_coords()] — parses inclusion/exclusion coordinate strings

The algorithm prioritizes exon classification (`first`, `internal`, `last`)
consistent with the event type (AFE, ALE, SE, etc.), followed by reciprocal
overlap fractions, intersection width, and protein‐coding status.
}
\keyword{internal}
