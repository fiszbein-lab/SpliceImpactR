% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/user_supplied_data.R
\name{get_user_data_post_di}
\alias{get_user_data_post_di}
\title{Format user-supplied post-DI (post-differential-inclusion) splicing results}
\usage{
get_user_data_post_di(df)
}
\arguments{
\item{df}{Data frame of post-DI results, detailed in description}
}
\value{
A data.table formatted like SpliceImpactR DI output
(get_differential_inclusion)
}
\description{
This function converts user-supplied event results into the internal
SpliceImpactR DI format. It accepts per-event statistics and ensures
each splicing event contains valid inclusion/exclusion structure.

## Requirements
**Event representation**
- Each splicing event must be split into two forms:
  - \code{INC}: the inclusion isoform
  - \code{EXC}: the exclusion isoform
- Alternative first/last exon events (AFE/ALE) or more abstract events may
 instead provide a single \code{SITE} form.

**Coordinates**
- \code{inc} column: genomic coordinates included in the given form
- \code{exc} column: genomic coordinates excluded in the given form
- Coordinates may be one or multiple ranges (e.g., "100-200" or "100-150;300-350")

- User **must supply `event_id`** (unique ID per splicing event, event_id =
event_type:x for form != SITE. event_id = gene:event_type for form = SITE.
Look at example output from get_differential_inclusion using test data for
more examples)
- Each event must be either:
  - **INC + EXC** forms (paired isoforms), or
  - **SITE** (single isoform)
- Required columns:
  `gene_id, chr, strand, inc, exc, form, event_id`

## Behavior
- Does **not** generate event IDs: user must provide them
- Constructs `site_id = event_type|gene_id|chr|inc|exc|form`
- `delta_psi`:
  - If missing: INC = +1, EXC = -1, SITE expands to +1 and -1 each to get
  all relevant comparisons
- `p.value`, `padj`:
  - If missing: set to 0
- All diagnostic fields
  (`cooks_max, n, n_used, n_samples, n_case,
    mean_psi_ctrl, mean_psi_case, n_control`)
   set to -1 if missing

## Validation
- Throws error if:
  - Any event lacks **INC+EXC** or **SITE**
  - An event mixes SITE with INC/EXC

## Output
Returns a `data.table` formatted like SpliceImpactR DI output.
Ready for annotation, pairing, enrichment, and PPI analysis.
}
\examples{
example_user_data <- data.frame(
  event_id = rep("A3SS:1", 8),
  event_type = "A3SS",
  gene_id = "ENSG00000158286",
  chr = "chrX",
  strand = "-",
  form = rep(c("INC","EXC"), each = 4),
  inc = c(
    rep("149608626-149608834", 4),
    rep("149608626-149608829", 4)
  ),
  exc = c(
    rep("", 4),
    rep("149608830-149608834", 4)
  ),
  inclusion_reads = c(30, 28, 25, 32,  2, 3, 4, 3),
  exclusion_reads = c(1, 2, 1, 1, 28, 27, 26, 30),
  sample = c("S1","S2","S3","S4","S1","S2","S3","S4"),
  condition = rep(c("case","case","control","control"), 2),
  stringsAsFactors = FALSE
)

# compute psi if missing, just for demo
post_di_user_data <- get_user_data_post_di(example_user_data)

}
