% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_differential_inclusion.R
\name{get_differential_inclusion}
\alias{get_differential_inclusion}
\title{Differential Inclusion Analysis from Hit Index Tables}
\usage{
get_differential_inclusion(
  DT,
  min_total_reads = 10L,
  minimum_proportion_containing_event = 0.5,
  cooks_cutoff = "Inf",
  adjust_method = "fdr",
  verbose = TRUE,
  parallel_glm = TRUE,
  chunk_size_glm = 1000,
  cores_glm = 1
)
}
\arguments{
\item{DT}{A `data.frame` or `data.table` containing at least the columns
`event_type`, `gene_id`, `chr`, `inc`, `exclusion_reads`,
`inclusion_reads`, `condition`, and `sample`.}

\item{min_total_reads}{Integer. Minimum total reads per site/sample
required for inclusion (default `10`).}

\item{minimum_proportion_containing_event}{Numeric in `[0,1]`. Minimum
fraction of samples per condition that must contain the event
(default `0.5`).}

\item{cooks_cutoff}{Character or numeric. Cook's distance cutoff:
`"4/n"`, `"Inf"`, `"none"`, or a numeric value.}

\item{adjust_method}{Character. Multiple-testing correction method passed
to [stats::p.adjust()] (default `"fdr"`).}

\item{verbose}{Logical. Print progress messages (default `TRUE`).}

\item{parallel_glm}{Logical. Use parallel fitting via
[fit_sites_parallel()] (default `TRUE`).}

\item{chunk_size_glm}{Integer. Number of sites per parallel chunk
(default `1000`).}

\item{cores_glm}{Integer. Number of parallel workers (default `1`).}
}
\value{
A `data.table` with one row per site containing:
  \itemize{
    \item Metadata columns (`site_id`, `event_type`, `event_id`, `gene_id`, ...)
    \item Sample counts (`n_samples`, `n_control`, `n_case`)
    \item Mean PSI per group (`mean_psi_ctrl`, `mean_psi_case`)
    \item deltaPSI (`delta_psi`)
    \item Raw and adjusted p-values (`p.value`, `padj`)
    \item Maximum Cook's distance (`cooks_max`)
  }
}
\description{
Performs per-site differential inclusion testing from a hit-index or
junction-form table. Each site is modeled with a quasi-binomial GLM
(`psi_adj ~ condition`) to estimate deltaPSI and significance, optionally
using parallel processing.
}
\details{
The function filters out low-coverage and low-presence events,
fills AFE/ALE sites with zero counts where necessary,
and then applies site-level GLMs. Parallelization uses
[BiocParallel] back-ends for reproducibility across platforms.
}
\examples{
sample_frame <- data.frame(path = c(check_extdata_dir('rawData/control_S5/'),
                                    check_extdata_dir('rawData/control_S6/'),
                                    check_extdata_dir('rawData/control_S7/'),
                                    check_extdata_dir('rawData/control_S8/'),
                                    check_extdata_dir('rawData/case_S1/'),
                                    check_extdata_dir('rawData/case_S2/'),
                                    check_extdata_dir('rawData/case_S3/'),
                                    check_extdata_dir('rawData/case_S4/')),
                           sample_name  = c("S5", "S6", "S7", "S8", "S1", "S2", "S3", "S4"),
                           condition    = c("control", "control", "control", "control", "case",  "case",  "case",  "case"),
                           stringsAsFactors = FALSE)
hit_index <- get_hitindex(sample_frame)
res <- get_differential_inclusion(hit_index)
head(res)

}
\seealso{
[fit_sites_parallel()], [cutoff_num()], [stats::glm()],
  [BiocParallel::bplapply()]
}
