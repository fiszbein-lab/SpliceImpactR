% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_annotations.R
\name{add_exon_coding_information}
\alias{add_exon_coding_information}
\title{Add per-exon coding and feature coordinates (internal)}
\usage{
add_exon_coding_information(gtf_df)
}
\arguments{
\item{gtf_df}{A \code{data.frame} or \code{data.table} containing GTF
annotations, typically produced by [load_gtf_long()]. Must include
columns \code{type}, \code{start}, \code{end}, \code{strand},
\code{transcript_id}, \code{exon_id}, and a unique \code{row_uid}.}
}
\value{
A \code{data.table} identical to the input \code{gtf_df} but
  with additional per-exon fields:
  \itemize{
    \item \code{cds_has}, \code{utr_has}, etc. â€” logical indicators
    \item Absolute (within-exon) start/stop coordinates (\code{_abs_*})
    \item Genomic coordinates (\code{_gen_*})
    \item Transcript-relative coordinates (\code{_rel_*})
    \item Feature lengths (\code{_len})
  }
}
\description{
Internal helper to annotate each exon in a GTF \code{data.table} with
strand-aware coding information. For every exon, the function records
whether it overlaps coding sequence (CDS), untranslated region (UTR),
start codon, or stop codon, together with absolute, genomic, and
transcript-relative coordinates.
}
\details{
The function:
\enumerate{
  \item Orders exons per transcript, respecting strand.
  \item Computes exon-wise coordinates for CDS, UTR, start/stop codons.
  \item Merges these annotations back into the exon-level GTF table.
}
It relies on \pkg{data.table} joins and by-group operations for speed.
}
\keyword{internal}
