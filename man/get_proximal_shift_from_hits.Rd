% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_multi_analysis.R
\name{get_proximal_shift_from_hits}
\alias{get_proximal_shift_from_hits}
\title{Classify splicing events as proximal or distal}
\usage{
get_proximal_shift_from_hits(hits)
}
\arguments{
\item{hits}{`data.frame` or `data.table` containing at least:
\itemize{
  \item `event_id`
  \item `event_type_inc`
  \item `strand_inc`
  \item `inc_inc`, `inc_exc`
  \item `delta_psi_inc`, `delta_psi_exc`
}}
}
\value{
A `data.table` identical to `hits` with an additional
column (named `V1`) specifying `"proximal"`, `"distal"`,
`"overlap"`, or `"nonTerminal"`.
}
\description{
Determines whether inclusion/exclusion events correspond to
proximal or distal terminal exon usage for **AFE** (Alternative
First Exon) and **ALE** (Alternative Last Exon) events, based on
genomic coordinates and strand orientation.
}
\details{
The function compares the genomic coordinates of the inclusion
(`inc_inc`) and exclusion (`inc_exc`) segments per event:
\itemize{
  \item For **AFE** events, proximal = exon with smaller start
        coordinate on the `+` strand (or larger end on `-` strand).
  \item For **ALE** events, proximal = exon with smaller start
        coordinate on the `+` strand (or larger end on `-` strand).
}
Events outside these types are labeled `"nonTerminal"`.

If \code{plot = TRUE}, a summary donut chart is printed showing
the proportion of proximal vs distal usage per event type.
}
\examples{
sample_frame <- data.frame(path = c(check_extdata_dir('rawData/control_S5/'),
                                    check_extdata_dir('rawData/control_S6/'),
                                    check_extdata_dir('rawData/control_S7/'),
                                    check_extdata_dir('rawData/control_S8/'),
                                    check_extdata_dir('rawData/case_S1/'),
                                    check_extdata_dir('rawData/case_S2/'),
                                    check_extdata_dir('rawData/case_S3/'),
                                    check_extdata_dir('rawData/case_S4/')),
                           sample_name  = c("S5", "S6", "S7", "S8", "S1", "S2", "S3", "S4"),
                           condition    = c("control", "control", "control", "control", "case",  "case",  "case",  "case"),
                           stringsAsFactors = FALSE)
hit_index <- get_hitindex(sample_frame)
res <- get_differential_inclusion(hit_index)
annotation_df <- get_annotation(load = "test")
matched <- get_matched_events_chunked(res, annotation_df$annotations, chunk_size = 2000)
x_seq <- attach_sequences(matched, annotation_df$sequences)
pairs <- get_pairs(x_seq, source="multi")
proximal_output <- get_proximal_shift_from_hits(pairs)
}
\seealso{
[plot_prox_dist()]
}
