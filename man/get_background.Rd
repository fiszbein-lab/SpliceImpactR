% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_background.R
\name{get_background}
\alias{get_background}
\title{Build a transcript-pair background with domain and length annotations}
\usage{
get_background(
  source = c("hit_index", "annotated", "user-given"),
  input,
  annotations,
  protein_features,
  keep_annotated_first_last = TRUE,
  minOverlap = 0.8
)
}
\arguments{
\item{source}{Character string specifying the source of the background.
One of:
\itemize{
  \item \code{"hit_index"} — use HIT index output directories.
  \item \code{"annotated"} — use all transcripts from the annotation.
  \item \code{"user-given"} — use a user-supplied list of transcript IDs.
}}

\item{input}{Source-specific input:
\itemize{
  \item For \code{"hit_index"}: a data.frame of paths with a \code{path} column.
  \item For \code{"annotated"}: ignored.
  \item For \code{"user-given"}: a character vector or data.frame containing \code{transcript_id}.
}}

\item{annotations}{A data.table annotations from \code{get_annotations}}

\item{protein_features}{A data.frame of protein domain or motif features
(e.g. InterPro, Pfam) with at least
\code{ensembl_transcript_id}, \code{ensembl_peptide_id},
\code{database}, and \code{name} columns from
\code{get_comprehensive_annotations}}

\item{keep_annotated_first_last}{Logical; passed to
\code{\link{read_background}} to control filtering of annotated
first/last exons. Defaults to \code{TRUE}.}

\item{minOverlap}{Numeric (0–1); minimum fraction overlap required when
matching exons between HIT index data and annotations. Defaults to 0.8.}
}
\value{
A \link[data.table]{data.table} in which each row represents
  a transcript pair annotated with gene ID, CDS/exon length differences,
  and protein domain differences. Columns include:
  \code{gene_id}, \code{transcript_id_1}, \code{transcript_id_2},
  \code{prot_aa_1}, \code{prot_aa_2}, \code{domains_1}, \code{domains_2},
  and related summary metrics.
}
\description{
Constructs a background dataset of transcript pairs suitable for
domain-level or exon-level enrichment analyses. Depending on the
\code{source} parameter, the function can derive the background from
HIT index results, annotated transcripts, or a user-provided list
of transcript IDs.
}
\details{
This function coordinates multiple internal utilities including
\code{\link{read_background}}, \code{\link{match_exon_table}},
\code{\link{make_transcript_pairs_with_lengths}}, and
\code{\link{get_domain_background}}.
}
\examples{

annots <- get_annotation(load = "test")
interpro_features <- get_protein_features(c("interpro"), annots$annotations, timeout = 600, test = TRUE)
protein_feature_total <- get_comprehensive_annotations(list(interpro_features))

# Build background from HIT index paths
sample_frame <- data.frame(path = c(check_extdata_dir('rawData/control_S5/'),
                                    check_extdata_dir('rawData/control_S6/'),
                                    check_extdata_dir('rawData/control_S7/'),
                                    check_extdata_dir('rawData/control_S8/'),
                                    check_extdata_dir('rawData/case_S1/'),
                                    check_extdata_dir('rawData/case_S2/'),
                                    check_extdata_dir('rawData/case_S3/'),
                                    check_extdata_dir('rawData/case_S4/')),
                           sample_name  = c("S5", "S6", "S7", "S8", "S1", "S2", "S3", "S4"),
                           condition    = c("control", "control", "control", "control", "case",  "case",  "case",  "case"),
                           stringsAsFactors = FALSE)
bg <- get_background(source = "hit_index",
                     input = sample_frame,
                     annotations = annots$annotations,
                     protein_features = protein_feature_total)

# Or from user-supplied transcript IDs
tx_ids <- c("ENST00000466994","ENST00000484435")
bg_user <- get_background(source = "user-given",
                          input = tx_ids,
                          annotations = annots$annotations,
                          protein_features = protein_feature_total)


}
\seealso{
\code{\link{get_domain_background}},
\code{\link{make_transcript_pairs_with_lengths}},
\code{\link{read_background}},
\code{\link{match_exon_table}}
}
