% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_pairs.R
\name{get_pairs}
\alias{get_pairs}
\title{Pair inclusion and exclusion forms of splicing events}
\usage{
get_pairs(x, source = c("paired", "multi"))
}
\arguments{
\item{x}{A data.frame or data.table containing splicing event information.}

\item{source}{Character string specifying input structure:
\describe{
  \item{\code{"paired"}}{(rMATS-like) requires exactly one INC and one EXC
    per event ID.}
  \item{\code{"multi"}}{(HITindex-like) pairs all positive and negative
    \code{delta_psi} values within each event.}
}}

\item{key_cols}{Character vector of columns that uniquely identify events.
Defaults to \code{"event_id"}.}
}
\value{
A \link[data.table]{data.table} where each row represents an
  inclusion–exclusion pair of the same event.
}
\description{
Builds paired tables of inclusion/exclusion forms for splicing events from
rMATS-like or HITindex-like inputs. In rMATS mode, events are paired when
both INC and EXC forms exist for a given event ID. In HITindex mode, all
positive and negative ΔPSI rows within each event are cross-joined.
}
\details{
In \code{source="paired"} mode, only events with exactly one INC and one EXC
row are retained. In \code{source="multi"} mode, all positive ΔPSI rows are
joined with all negative ΔPSI rows (cartesian join) within each event.
}
\examples{
sample_frame <- data.frame(path = c(check_extdata_dir('rawData/control_S5/'),
                                    check_extdata_dir('rawData/control_S6/'),
                                    check_extdata_dir('rawData/control_S7/'),
                                    check_extdata_dir('rawData/control_S8/'),
                                    check_extdata_dir('rawData/case_S1/'),
                                    check_extdata_dir('rawData/case_S2/'),
                                    check_extdata_dir('rawData/case_S3/'),
                                    check_extdata_dir('rawData/case_S4/')),
                           sample_name  = c("S5", "S6", "S7", "S8", "S1", "S2", "S3", "S4"),
                           condition    = c("control", "control", "control", "control", "case",  "case",  "case",  "case"),
                           stringsAsFactors = FALSE)
hit_index <- get_hitindex(sample_frame)
res <- get_differential_inclusion(hit_index)
annots <- get_annotation(load = "test")
matched <- get_matched_events_chunked(res, annots$annotations, chunk_size = 2000)
x_seq <- attach_sequences(matched, annots$sequences)
pairs <- get_pairs(x_seq, source="multi")
}
