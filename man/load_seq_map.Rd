% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_annotations.R
\name{load_seq_map}
\alias{load_seq_map}
\title{Build a compact transcript protein sequence map (internal)}
\usage{
load_seq_map(
  gtf_df,
  txfa_path,
  aafa_path,
  take_tx_cds_slice = TRUE,
  keep_sequences = TRUE,
  add_row_uids = TRUE
)
}
\arguments{
\item{gtf_df}{A \code{data.frame} or \code{data.table} produced by
[load_gtf_long()], containing at least \code{gene_id},
\code{transcript_id}, \code{protein_id}, and optionally
\code{row_uid}.}

\item{txfa_path}{Character string giving the path to the GENCODE
transcript FASTA file (e.g. \code{gencode.v45.pc_transcripts.fa.gz}).}

\item{aafa_path}{Character string giving the path to the GENCODE
protein FASTA file (e.g. \code{gencode.v45.pc_translations.fa.gz}).}

\item{take_tx_cds_slice}{Logical; if \code{TRUE}, restricts transcript
sequences to their coding region based on the \code{CDS:start-end}
annotation in the FASTA header.}

\item{keep_sequences}{Logical; if \code{TRUE}, include sequence strings
in the output table, otherwise store \code{NA_character_}.}

\item{add_row_uids}{Logical; if \code{TRUE}, attaches corresponding
\code{row_uid}s for genes and transcripts from \code{gtf_df}.}
}
\value{
A \code{data.table} containing, for each transcript:
  \describe{
    \item{row_uid}{Row index within the output mapping.}
    \item{gene_id, transcript_id, protein_id}{Identifiers from GENCODE.}
    \item{transcript_seq, protein_seq}{Optional sequence strings.}
    \item{gene_row_uid, transcript_row_uid}{Original UID references (if added).}
  }
}
\description{
Internal helper that integrates information from a GTF, transcript FASTA,
and protein FASTA to produce a compact mapping of genes, transcripts,
and proteins, optionally including nucleotide and amino-acid sequences.
}
\details{
The function combines identifiers from GTF features, transcript FASTA
headers, and protein FASTA headers to construct a unified mapping.
It uses \pkg{Biostrings} to load FASTA data and
\pkg{data.table} for efficient joins.
}
\keyword{internal}
